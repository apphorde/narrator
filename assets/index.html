<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Narrator</title>
    <link
      href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.16/dist/tailwind.min.css"
      rel="stylesheet"
    />
  </head>
  <body>
    <div class="flex items-center justify-around h-screen w-screen">
      <section class="w-full py-12 md:py-24 lg:py-32 xl:py-48">
        <div class="container px-4 md:px-6">
          <div class="flex flex-col items-center space-y-4 text-center">
            <div class="space-y-2">
              <h1
                class="text-3xl font-bold tracking-tighter sm:text-4xl md:text-5xl lg:text-6xl/none"
              >
                Turn text into audio with one click
              </h1>
            </div>
            <div class="w-full max-w-sm space-y-2">
              <form class="flex space-x-2">
                <input
                  type="text"
                  id="input"
                  class="flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 max-w-lg flex-1"
                  placeholder="Text to narrate"
                /><button
                  class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 py-2"
                  type="submit"
                >
                  Speak
                </button>
              </form>
              <p class="text-xs text-gray-500 dark:text-gray-400">
                <a class="underline underline-offset-2" download id="link">
                  <span id="uid" class="block text-sm text-gray-500"></span>
                </a>
              </p>
            </div>
          </div>
        </div>
      </section>
    </div>
    <script type="module">
      import tts from "https://tts.jsfn.run/index.mjs";

      console.log = (...args) =>
        (document.body.innerHTML += String(args)+JSON.stringify(args));
      window.addEventListener("DOMContentLoaded", () => {
        const f = document.querySelector("form");
        f.onsubmit = async (e) => {
          try {
            e.preventDefault();
            const r = await tts(input.value);
            link.href = URL.createObjectURL(new Blob([await r.arrayBuffer()]));
            uid.innerText = link.href;
          } catch (e) {
            console.log(e);
          }
        };
      });
    </script>
  </body>
</html>
